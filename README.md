Intel Data Center
 


INTRODUCTION: Intel, the semiconductor manufacturing powerhouse, is planning on building a new data center. Energy availability and usage are some of the key considerations in deciding on a location of the data center. For example, which regions produce a surplus of energy, and are therefore more likely to provide energy at cheaper prices?  Which regions rely more on renewable energy sources? 

In this  project, co-designed with Intel's Sustainability Team, you'll  write SQL queries that will power  your analysis and create visualizations that will help the Intel team select the best location for the new data center. 

HOW IT WORKS: Follow the prompts in the questions below to investigate your data. Post your answers in the provided boxes: the yellow boxes for the queries you write, purple boxes for visualizations and blue boxes for text-based answers. When you're done, export your document as a pdf file and submit it on the Milestone page ‚Äì see instructions for creating a PDF at the end of the Milestone.

RESOURCES: If you need hints on the Milestone or are feeling stuck, there are multiple ways of getting help. Attend Drop-In Hours to work on these problems with your peers, or reach out to the HelpHub if you have questions. Good luck!

SQL App: Here‚Äôs that link to our specialized SQL app, where you‚Äôll write your SQL queries and interact with the data. 


‚Äî Data Set Descriptions 
In this project  you‚Äôll query 3 datasets as well as write a query to generate a new dataset that you will use in your tableau visualizations. The intel.energy_data dataset will be the main dataset you‚Äôll be working with. The intel.energy_by_plant and intel.power_plants datasets will be joined for an in-depth analysis of energy production at the power plant level. 

Read below to learn more about the datasets and their features.

intel.energy_data: Contains information about daily energy production and consumption for different regions in the United States. 
‚óè	balancing_authority - A Balancing Authority is responsible for maintaining the electricity balance within its region. This is a company that makes sure electricity is being exchanged between electric providers and regions so that no region runs out of electricity due to high demand.
‚óè	date - The date the energy was produced.
‚óè	region - The electric service area within a geographic area of the USA. e.g. California, Midwest, etc.
‚óè	time_at_end_of_hour - The time and date after energy was generated, .e.g., energy generated between 1pm-2pm will show up as 2pm in this field.
‚óè	demand - The energy demand in megawatts (MW)  on the grid (what the houses/business are using).
‚óè	net_generation - The energy produced in MW in  the region by all sources e.g., wind, coal, nuclear, etc.
‚óè	all_petroleum_products - The energy produced in MW by petroleum products.
‚óè	coal - The energy produced in MW by all coal products
‚óè	hydropower_and_pumped_storage - The energy produced in MW by water power and pumped heat sources.
‚óè	natural_gas - The energy produced in MW by natural gas sources
‚óè	nuclear - The energy produced in MW from nuclear fuel sources
‚óè	solar - The energy produced in MW by solar panels and other solar energy capturing methods.
‚óè	wind - The energy produced in MW from wind turbines and other wind sources.

intel.power_plants: Contains general  information about power plants in the United States.
‚óè	plant_name  - The name of the power plant.
‚óè	plant_code - The unique identifier of the plant.
‚óè	region - The region in the US where the power plant is located. Matches the regions in the intel.energy_data
‚óè	state - The state where the power plant is located.
‚óè	primary_technology - The primary technology used to generate electricity at the power plant.

intel.energy_by_plant: Contains total energy production information at the plant for the year 2022.
‚óè	plant_name  - The name of the power plant.
‚óè	plant_code - The unique identifier of the plant.
‚óè	energy_type - The kind of energy generated by the power plant. Either renewable energy or fossil fuel.
‚óè	energy_generated_mw - The total energy generated, in MegaWatts, at the plant for the year 2022.
________________________________________

‚Äî Task 1: Energy Generation
Let‚Äôs first identify regions that are net energy producers. Not all regions generate enough energy to meet the local demand. Some regions purchase power from other regions, while others sell their surplus to regions in need. 

A.	Write a query using the intel.energy_data table that calculates the sum total of energy produced, grouped by each region. Sort the output by highest total energy. Which region has the highest positive total energy?

HINT: Total energy is equal to the difference between  net_generation and demand.

SELECT 
  DISTINCT region,
  SUM(net_generation - demand) AS Total_energy_produced
FROM intel.energy_data
GROUP BY region
ORDER BY Total_energy_produced DESC
	
Mid-Atlantic has the highest amount of energy produced with 31,693,087 MW, and the second place is Northwest (21,685,235
MW) and following 3rd is Southwest (14,986,086 MW).

 


B.	Intel is interested in regions that generate a large amount of energy from renewable sources. Renewable energy is defined as any energy generated from hydropower_and_pumped_storage, wind, and solar sources. 

Write a query that calculates the sum total of renewable energy by region. Sort the output by the region with the highest renewable energy. What are the top two regions for total renewable energy production?

HINT: You need to add the 3 energy sources together in one line before doing your group by: SUM(col1 + col2 + col3) AS new_column

SELECT 
  DISTINCT region,
  SUM(hydropower_and_pumped_storage + solar + wind) AS Total_natural_energy
FROM
  intel.energy_data
GROUP BY 
  region
ORDER BY Total_natural_energy DESC
	
Northwest is the region has the highest natural energy with 199,266,574 MW in total. Northwest has a huge amount of hydro power with many wind turbine farms and dams.  The second region is Texas with 131,367,234 MW in total natural energy and it also has the highest amount of wind. Central is the third top in the chart.

C.	Modify your query slightly so that it calculates the percentage of renewable energy by region. 

HINT: Divide the amount of renewable energy by the sum total of net_generation, and then multiply the result by 100.
SELECT 
  DISTINCT region,
  SUM(hydropower_and_pumped_storage + solar + wind) / SUM(net_generation) * 100
  AS per_natural_energy
FROM
  intel.energy_data
GROUP BY region
ORDER BY per_natural_energy DESC

D.	Which regions change from the top 3 when looking at total renewable energy vs percentage of renewable energy? 
Central produces least in total of renewable energy; However, California produces huge amount of solar that gives California the highest percent of total natural energy with 37 % of all energy it produces in renewable energy. Northwest has the highest percent with 52% of total natural energy and Central is the second place with 41% of its energy being green. 


‚Äî Task 2: Generating New Data by Energy Type
Intel would like to know how renewable energy and fossil fuels trend over time. In order to do this, you will first need to generate a new table using your SQL knowledge and the  intel.energy_data table before visualizing trends in Tableau Cloud. 


A.	Write a query that calculates the renewable energy generated for each row. Return only the date, region, and energy_generated_mw columns. 

Note: energy_generated_mw is the alias for hydropower_and_pumped_storage + wind + solar.

SELECT 
  date, 
  region,
  SUM(hydropower_and_pumped_storage + solar+ wind) AS energy_generated_mw 
FROM 
  intel.energy_data
GROUP BY
  date, region

After showing the result of the query to your manager, she tells you that she wants it to be clear that the energy_generated_mw column is referring to renewable energy types. She asks you to create a new column called energy_type that has the value ‚Äòrenewable energy‚Äô for each row. 

A colleague teaches you a simple method to do this. When writing your query, add an additional column after your select statement. Here is an example:

SELECT
  *, -- any relevant fields to the query
  'renewable energy' AS energy_type
FROM intel.energy_data

B.	Modify your query from Part A. to include the energy_type column.

SELECT 
  date, 
  region,
  'renewable energy' AS energy_type,
  SUM(hydropower_and_pumped_storage + solar+ wind) AS energy_generated_mw 
FROM 
  intel.energy_data
GROUP BY
  date, region
ORDER BY 
  date ASC

C.	Next, write a new query that calculates the fossil fuel energy generated for each row. As in Part A., return only the date, region, and energy_generated_mw columns, where energy_generated_mw is now the alias for all_petroleum_products + coal + natural_gas + nuclear + other_fuel_sources.
SELECT 
  date, 
  region,
  SUM(all_petroleum_products + coal + natural_gas + nuclear + other_fuel_sources) 
AS energy_generated_mw  
FROM 
  intel.energy_data
GROUP BY
  date, region 
ORDER BY 
  date ASC

D.	Modify your query in Part C. to include the energy_type column. This column should have the value ‚Äòfossil fuel‚Äô  for each row. 

HINT: This is very similar to Part B.!
SELECT 
  date, 
  region,
  'fossil fuel' AS energy_type, 
  SUM(all_petroleum_products + coal + natural_gas + nuclear + other_fuel_sources) 
AS energy_generated_mw  
FROM 
  intel.energy_data
GROUP BY
  date, region 
ORDER BY 
  date ASC

E.	Your queries from Parts B. and D. should both have the columns date, region, energy_generated, and energy_type. Write one final query that UNIONs these two together.
 
SELECT 
  date, 
  region,
  'renewable energy' AS energy_type,
  SUM(hydropower_and_pumped_storage + solar+ wind) AS energy_generated_mw 
FROM 
  intel.energy_data
GROUP BY
  date, region

UNION 
SELECT 
  date, 
  region,
  'fossil fuel' AS energy_type, 
  SUM(all_petroleum_products + coal + natural_gas + nuclear + other_fuel_sources) 
AS energy_generated_mw  
FROM 
  intel.energy_data
GROUP BY
  date, region 
ORDER BY 
  date ASC,energy_generated_mw DESC ;



Task 3: Aggregating Power Plant Data
Intel has provided you with additional data in order to reach the best conclusion about the location of its next data center. In this task you will be working with two tables intel.power_plants and intel.energy_by_power_plant. You will need to join these tables before you can aggregate them to help the Intel team with their analysis.

A.	 Join the intel.power_plants and intel.energy_by_power_plant data on the plant_code. This joined table will form the basis for the rest of the task. 

If done correctly, your output will have 2,504 rows.

SELECT *
FROM intel.power_plants AS p 
INNER JOIN intel.energy_by_plant AS e 
ON p.plant_code = e.plant_code


Note:  It is recommended to use the WITH keyword for the remainder of this Task to simplify  your queries.  For a refresher, rewatch ‚ÄúüçøThe  WITH  Keyword‚Äù in SkillBuilder 6.

B.	Write a query that returns the total number of renewable energy power plants for each region. Which region has the most renewable power plants?

WITH plant_table AS(
SELECT *
FROM intel.power_plants AS p 
INNER JOIN intel.energy_by_plant AS e 
ON p.plant_code = e.plant_code)
SELECT 
  DISTINCT region,
  COUNT(*) AS renewable_plant
FROM 
  plant_table
WHERE
  fuel_types IN ('SUN', 'WAT', 'MWH', 'WND')
GROUP BY 
  region
ORDER BY 
  renewable_plant DESC
	
Midwest is the highest region has the most renewable power plants with 217 plants.
		
C.	Next, write a query that returns both  the total number of power plants and the total energy generated, specifically from plants that use ‚ÄúSolar Photovoltaic‚Äù technology, grouped by each region. 

WITH plant_table AS(
SELECT *
FROM intel.power_plants AS p 
INNER JOIN intel.energy_by_plant AS e 
ON p.plant_code = e.plant_code)
SELECT 
  DISTINCT region,
  COUNT(*) AS renewable_plant
FROM 
  plant_table
WHERE
  primary_technology IN('Solar Photovoltaic')
GROUP BY 
  region

D.	Modify your query in part C to only show regions having at least 50 power plants that use ‚ÄúSolar Photovoltaic‚Äù technology. What can you infer about the efficiency (or size) of the power plants in the Midwest region relative to the other regions in your output?


WITH plant_table AS(
SELECT *
FROM intel.power_plants AS p 
INNER JOIN intel.energy_by_plant AS e 
ON p.plant_code = e.plant_code)
SELECT 
  DISTINCT region,
  COUNT(*) AS renewable_plant
FROM 
  plant_table
WHERE
  primary_technology IN('Solar Photovoltaic') 
GROUP BY 
  region
HAVING 
  COUNT(*) >= 50
ORDER BY 
  renewable_plant DESC
	
Midwest has 71 plants using Solar Photovoltaic technology. There are 217 other green plants in Midwest, it means Midwest has 32% of its plants comes from solar energy.


Note: There is more Tableau work up ahead! If you want to skip the LevelUp jump straight to Task 4 below!

‚Äî LevelUp: Hourly Trends in Renewable Energy
Before moving on to your Tableau Visualizations, let‚Äôs investigate how renewable energy generation fluctuates with the Solar Photovoltaic‚Äù technology time of day. 

A.	Write a query that calculates the total renewable energy generated in each region for each hour of the day. 

HINT: You‚Äôll need to use the date_part function to get the hour from the time_at_end_of_hour column. Your result should only have the values 0-23 for that new column. 
WITH hour_day_table AS(
SELECT
region,
date_part('hour',time_at_end_of_hour) AS hour_a_day,
SUM(hydropower_and_pumped_storage + solar + wind) AS Total_renewable_energy 

FROM intel.energy_data
WHERE date_part('hour',time_at_end_of_hour) BETWEEN 0 AND 23 
GROUP BY region, date_part('hour',time_at_end_of_hour) )
SELECT 
  DISTINCT region,
  hour_a_day, 
  Total_renewable_energy
FROM hour_day_table
ORDER BY region ASC, hour_a_day ASC


B.	Modify your query to filter to the ‚ÄòCalifornia‚Äô and ‚ÄòNorthwest‚Äô regions only.
WITH hour_day_table AS(
SELECT
region,
date_part('hour',time_at_end_of_hour) AS hour_a_day,
SUM(hydropower_and_pumped_storage + solar + wind) AS Total_renewable_energy 

FROM intel.energy_data
WHERE date_part('hour',time_at_end_of_hour) BETWEEN 0 AND 23 
AND 
region IN ('California','Northwest')
GROUP BY region, date_part('hour',time_at_end_of_hour) )
SELECT 
  DISTINCT region,
  hour_a_day, 
  Total_renewable_energy
FROM 
  hour_day_table

C.	Use the built-in visualizer in the SQL app to plot a line graph of the energy generated for each hour of the day and colored by the region. If done correctly you should have two lines in your visualization.
 

D.	What can you say about the renewable energy generation between California (CAL) and the Pacific Northwest (NW)?
Northwest produces much more renewable energy than California. Northwest is the region consistently includes the states of Oregon, Washington, Idaho, Montana and Wyoming. Washington and Oregon have the largest producer of hydroelectric power in the US, including the Grand Coulee Dam on the Columbia River. Idaho and Oregon have wind energy production. Washington and Pacific Northwest provide biomass resources from agriculture and forest which can produce up to hundred gallons of biodiesel per year. 


‚Äî Task 4: Visualizing and Analyzing Using Tableau
Phew! Now that you‚Äôve gotten the queries out of the way, you‚Äôre ready to dive into investigating the best regions for Intel to put its next data center. The remaining Tasks will be completed in Tableau, and will focus on visualizing and analyzing your results. Click this link to navigate  to the workbook you‚Äôll use to complete the remainder of this Project. 

Once you‚Äôve published your Tableau Workbook, paste the Share Link in the box below.

Note: Your share link must begin with: 
https://prod-useast-b.online.tableau.com/#/site/globaltech/workbooks/...
https://prod-useast-b.online.tableau.com/#/site/globaltech/workbooks/2479018?:origin=card_share_link


Continue to post your answers in the provided boxes: purple boxes for your visualizations, and blue boxes for text-based answers.

A.	On the ‚ÄúNet Production‚Äù sheet, create a bar chart of net production , by region. Sort the chart in descending order, from tallest to smallest.

The net energy produced is calculated by subtracting the total energy demand from the total energy generation. This is already created  in the field called Net Production.


 

B.	Next, on the ‚ÄúRenewable Energy‚Äù sheet, create a bar chart illustrating which regions generate the greatest percentage of renewable energy.

HINT: In Tableau, you have a field called Percent Renewable Energy
.
Create a bar chart in descending order of regions with the most renewable energy percentage.

 

C.	On the ‚ÄúEnergy Source by Region‚Äù sheet, create a line chart of the energy generated for each energy source (fossil fuels & renewable energy)  at the weekly date level. Add a filter for the region to your chart.

For this chart, you will use the energy_by_source dataset loaded into your Tableau workbook. 
	
 

D.	On the ‚ÄúEnergy by State‚Äù sheet create a bar chart of the total energy generated by each state and energy type. Color the bars by energy type. Include a region filter in your chart to reduce the amount of bars shown.

For this chart you will use the power_plant_energy dataset that you created. You can select the data source in the upper left hand column in Tableau. 

 

‚Äî Task 5: Communicating Results
Your manager wants you to share the visualizations you created in Task 4 with the Sustainability team for visibility. She has created a dashboard with your visualizations (see the ‚ÄúDashboard‚Äù sheet in Tableau) and has asked you to write  a short paragraph explaining which region you recommend that the next data center be built.

A.	In 1-2 paragraphs, summarize what can be gleaned from your visualizations. What region and state do you think is best and why?

The production ratio of renewable energy to fossil fuel of Northwest is 3.36, which is the highest among other regions such as California and Texas. Texas has the highest amount of fossil fuel it produced recently. California has the highest percent of total natural energy with 37 % of all energy it produces in renewable energy. However, Northwest has the highest percent with 52% of total natural energy and Central is the second place with 41% of its energy being green. Northwest produces much more renewable energy than California and Central. Northwest is the region consistently includes the states of Oregon, Washington, Idaho, Montana and Wyoming. Washington state and the Pacific Northwest, the primary metro transit system is called "King County Metro" which operates primarily within King County, Washington, including Seattle, and is commonly referred to simply as "Metro"; it provides bus service, the Seattle Streetcar, and connects to Sound Transit's light rail system (Link) and express bus services. Washington is directly north of where the head quarter of Intel is located, and is also a good choice geographically considering the Intel HQ is in Oregon. This means less travel time for employees to travel between the two locations, ultimately reducing the essential amounts of emissions needed for the daily journey. Seattle, Washington is a major technology hub, which can be a good location to attract technology talent candidates.
